2024-10-23 19:45:47,179 - INFO - Created new session log file.
2024-10-23 19:45:47,181 - INFO - ##################################################
2024-10-23 19:45:47,181 - INFO - STEP 1 : Extarcting data from kagggle
2024-10-23 19:45:47,182 - INFO - ##################################################
2024-10-23 19:45:47,182 - INFO - Starting data download...
2024-10-23 19:45:49,110 - INFO - Files in the zip archive: ['Credit card transactions - India - Simple.csv']
2024-10-23 19:45:49,110 - INFO - Processing the data in chunks...
2024-10-23 19:45:49,134 - INFO - Processed 10000 rows of data.
2024-10-23 19:45:49,151 - INFO - Processed 10000 rows of data.
2024-10-23 19:45:49,162 - INFO - Processed 6052 rows of data.
2024-10-23 19:45:49,268 - INFO - Data processing and transmission to NiFi completed successfully.
2024-10-23 19:45:55,393 - INFO - Appending to existing log file.
2024-10-23 19:45:55,504 - INFO - ##################################################
2024-10-23 19:45:55,504 - INFO - STEP 2 : Pushing the data to table
2024-10-23 19:45:55,504 - INFO - ##################################################
2024-10-23 19:45:55,560 - INFO - Table 'transactions' created.
2024-10-23 19:46:15,593 - INFO - Data processing completed successfully. Total records pushed: 26052.
2024-10-23 19:47:05,295 - INFO - Appending to existing log file.
2024-10-23 19:47:05,296 - INFO - ##################################################
2024-10-23 19:47:05,296 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:05,296 - INFO - ##################################################
2024-10-23 19:47:05,296 - INFO - Establishing database connection...
2024-10-23 19:47:05,423 - INFO - Database connection established successfully.
2024-10-23 19:47:05,435 - INFO - SQL filename: Average Spend Per Transaction by Card Type.sql
2024-10-23 19:47:05,436 - INFO - SQL query read from file: SELECT 
    card_type, 
    YEAR(transaction_date) AS transaction_year,
    MONTH(transaction_date) AS transaction_month,
    AVG(amount) AS average_spend_per_transaction
FROM 
    transactions
GROUP BY 
    card_type, 
    YEAR(transaction_date),
    MONTH(transaction_date);
2024-10-23 19:47:05,630 - INFO - SQL query executed successfully. Retrieved 80 rows.
2024-10-23 19:47:05,637 - INFO - Cursor closed.
2024-10-23 19:47:05,638 - INFO - Database connection closed.
2024-10-23 19:47:07,899 - INFO - Appending to existing log file.
2024-10-23 19:47:07,900 - INFO - ##################################################
2024-10-23 19:47:07,900 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:07,900 - INFO - ##################################################
2024-10-23 19:47:07,900 - INFO - Establishing database connection...
2024-10-23 19:47:07,955 - INFO - Database connection established successfully.
2024-10-23 19:47:07,965 - INFO - SQL filename: Cumulative Spend by City.sql
2024-10-23 19:47:07,966 - INFO - SQL query read from file: WITH CumulativeSpending AS (
    SELECT 
        city,
        transaction_date,
        SUM(amount) OVER (PARTITION BY city ORDER BY transaction_date) AS cumulative_spend
    FROM 
        transactions
)
SELECT 
    city,
    MIN(transaction_date) AS first_date_to_reach_500k
FROM 
    CumulativeSpending
WHERE 
    cumulative_spend >= 500000
GROUP BY 
    city;

2024-10-23 19:47:08,815 - INFO - SQL query executed successfully. Retrieved 796 rows.
2024-10-23 19:47:08,823 - INFO - Cursor closed.
2024-10-23 19:47:08,825 - INFO - Database connection closed.
2024-10-23 19:47:11,594 - INFO - Appending to existing log file.
2024-10-23 19:47:11,595 - INFO - ##################################################
2024-10-23 19:47:11,595 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:11,595 - INFO - ##################################################
2024-10-23 19:47:11,595 - INFO - Establishing database connection...
2024-10-23 19:47:11,636 - INFO - Database connection established successfully.
2024-10-23 19:47:11,643 - INFO - SQL filename: Fastest Growth in Spending.sql
2024-10-23 19:47:11,643 - INFO - SQL query read from file: WITH TransactionCounts AS (
    SELECT 
        card_type,
        COUNT(*) AS transaction_count,
        SUM(amount) AS total_spend
    FROM 
        transactions
    GROUP BY 
        card_type
)
SELECT TOP 1 
    card_type,
    transaction_count,
    total_spend,
    (total_spend * 1.0 / transaction_count) AS average_spend_per_transaction
FROM 
    TransactionCounts
ORDER BY 
    average_spend_per_transaction DESC;

2024-10-23 19:47:11,691 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 19:47:11,698 - INFO - Cursor closed.
2024-10-23 19:47:11,699 - INFO - Database connection closed.
2024-10-23 19:47:15,770 - INFO - Appending to existing log file.
2024-10-23 19:47:15,770 - INFO - ##################################################
2024-10-23 19:47:15,770 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:15,770 - INFO - ##################################################
2024-10-23 19:47:15,770 - INFO - Establishing database connection...
2024-10-23 19:47:15,821 - INFO - Database connection established successfully.
2024-10-23 19:47:15,832 - INFO - SQL filename: Highest Spending Gender.sql
2024-10-23 19:47:15,832 - INFO - SQL query read from file: SELECT 
    city,
    gender,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    gender
ORDER BY 
    city, 
    total_spend DESC;

2024-10-23 19:47:15,926 - INFO - SQL query executed successfully. Retrieved 1876 rows.
2024-10-23 19:47:15,937 - INFO - Cursor closed.
2024-10-23 19:47:15,941 - INFO - Database connection closed.
2024-10-23 19:47:17,977 - INFO - Appending to existing log file.
2024-10-23 19:47:17,978 - INFO - ##################################################
2024-10-23 19:47:17,978 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:17,978 - INFO - ##################################################
2024-10-23 19:47:17,978 - INFO - Establishing database connection...
2024-10-23 19:47:18,029 - INFO - Database connection established successfully.
2024-10-23 19:47:18,037 - INFO - SQL filename: Spend by Gender Across Cities.sql
2024-10-23 19:47:18,037 - INFO - SQL query read from file: SELECT 
    city,
    gender,
    SUM(amount) AS total_spend,
    (SUM(amount) * 100.0 / (SELECT SUM(amount) FROM transactions WHERE city = ct.city)) AS percentage_contribution
FROM 
    transactions ct
GROUP BY 
    city, 
    gender;
2024-10-23 19:47:18,148 - INFO - SQL query executed successfully. Retrieved 1876 rows.
2024-10-23 19:47:18,161 - INFO - Cursor closed.
2024-10-23 19:47:18,162 - INFO - Database connection closed.
2024-10-23 19:47:19,825 - INFO - Appending to existing log file.
2024-10-23 19:47:19,826 - INFO - ##################################################
2024-10-23 19:47:19,826 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:19,826 - INFO - ##################################################
2024-10-23 19:47:19,827 - INFO - Establishing database connection...
2024-10-23 19:47:19,877 - INFO - Database connection established successfully.
2024-10-23 19:47:19,887 - INFO - SQL filename: Spend Distribution Across Card Types.sql
2024-10-23 19:47:19,888 - INFO - SQL query read from file: SELECT 
    card_type, 
    MAX(amount) AS highest_spend_amount, 
    MIN(amount) AS lowest_spend_amount
FROM 
    transactions
GROUP BY 
    card_type;
2024-10-23 19:47:19,929 - INFO - SQL query executed successfully. Retrieved 4 rows.
2024-10-23 19:47:19,933 - INFO - Cursor closed.
2024-10-23 19:47:19,943 - INFO - Database connection closed.
2024-10-23 19:47:22,824 - INFO - Appending to existing log file.
2024-10-23 19:47:22,825 - INFO - ##################################################
2024-10-23 19:47:22,825 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:22,825 - INFO - ##################################################
2024-10-23 19:47:22,825 - INFO - Establishing database connection...
2024-10-23 19:47:22,876 - INFO - Database connection established successfully.
2024-10-23 19:47:22,886 - INFO - SQL filename: Top 5 Expense Categories.sql
2024-10-23 19:47:22,886 - INFO - SQL query read from file: 
SELECT top 5
    exp_type, 
    SUM(amount) AS total_spend,
    (SUM(amount) * 100.0 / (SELECT SUM(amount) FROM DEProject.dbo.transactions)) AS percentage_contribution
FROM 
    [transactions]
GROUP BY 
    exp_type
ORDER BY 
    total_spend DESC;
2024-10-23 19:47:23,019 - INFO - SQL query executed successfully. Retrieved 5 rows.
2024-10-23 19:47:23,024 - INFO - Cursor closed.
2024-10-23 19:47:23,025 - INFO - Database connection closed.
2024-10-23 19:47:25,990 - INFO - Appending to existing log file.
2024-10-23 19:47:25,991 - INFO - ##################################################
2024-10-23 19:47:25,991 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:25,991 - INFO - ##################################################
2024-10-23 19:47:25,991 - INFO - Establishing database connection...
2024-10-23 19:47:26,053 - INFO - Database connection established successfully.
2024-10-23 19:47:26,062 - INFO - SQL filename: Weekend vs Weekday Transaction Patterns.sql
2024-10-23 19:47:26,063 - INFO - SQL query read from file: SELECT 
    city,
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END AS day_type,
    COUNT(*) AS total_transactions,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END;

2024-10-23 19:47:26,130 - INFO - SQL query executed successfully. Retrieved 1783 rows.
2024-10-23 19:47:26,144 - INFO - Cursor closed.
2024-10-23 19:47:26,145 - INFO - Database connection closed.
2024-10-23 19:47:29,492 - INFO - Appending to existing log file.
2024-10-23 19:47:29,492 - INFO - ##################################################
2024-10-23 19:47:29,492 - INFO - STEP 3 : Creating Reports
2024-10-23 19:47:29,492 - INFO - ##################################################
2024-10-23 19:47:29,492 - INFO - Establishing database connection...
2024-10-23 19:47:29,533 - INFO - Database connection established successfully.
2024-10-23 19:47:29,544 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 19:47:29,544 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 19:47:29,662 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 19:47:29,666 - INFO - Cursor closed.
2024-10-23 19:47:29,669 - INFO - Database connection closed.
2024-10-23 19:58:53,180 - INFO - Appending to existing log file.
2024-10-23 19:58:53,182 - INFO - ##################################################
2024-10-23 19:58:53,182 - INFO - STEP 3 : Creating Reports
2024-10-23 19:58:53,182 - INFO - ##################################################
2024-10-23 19:58:53,182 - INFO - Establishing database connection...
2024-10-23 19:58:53,243 - INFO - Database connection established successfully.
2024-10-23 19:58:53,244 - INFO - SQL filename: Average Spend Per Transaction by Card Type.sql
2024-10-23 19:58:53,244 - INFO - SQL query read from file: SELECT 
    card_type, 
    YEAR(transaction_date) AS transaction_year,
    MONTH(transaction_date) AS transaction_month,
    AVG(amount) AS average_spend_per_transaction
FROM 
    transactions
GROUP BY 
    card_type, 
    YEAR(transaction_date),
    MONTH(transaction_date);
2024-10-23 19:58:53,433 - INFO - SQL query executed successfully. Retrieved 80 rows.
2024-10-23 19:58:53,439 - INFO - Cursor closed.
2024-10-23 19:58:53,441 - INFO - Database connection closed.
2024-10-23 19:58:57,676 - INFO - Appending to existing log file.
2024-10-23 19:58:57,677 - INFO - ##################################################
2024-10-23 19:58:57,677 - INFO - STEP 3 : Creating Reports
2024-10-23 19:58:57,677 - INFO - ##################################################
2024-10-23 19:58:57,677 - INFO - Establishing database connection...
2024-10-23 19:58:57,731 - INFO - Database connection established successfully.
2024-10-23 19:58:57,732 - INFO - SQL filename: Cumulative Spend by City.sql
2024-10-23 19:58:57,732 - INFO - SQL query read from file: WITH CumulativeSpending AS (
    SELECT 
        city,
        transaction_date,
        SUM(amount) OVER (PARTITION BY city ORDER BY transaction_date) AS cumulative_spend
    FROM 
        transactions
)
SELECT 
    city,
    MIN(transaction_date) AS first_date_to_reach_500k
FROM 
    CumulativeSpending
WHERE 
    cumulative_spend >= 500000
GROUP BY 
    city;

2024-10-23 19:58:58,745 - INFO - SQL query executed successfully. Retrieved 796 rows.
2024-10-23 19:58:58,753 - INFO - Cursor closed.
2024-10-23 19:58:58,754 - INFO - Database connection closed.
2024-10-23 19:59:04,984 - INFO - Appending to existing log file.
2024-10-23 19:59:04,984 - INFO - ##################################################
2024-10-23 19:59:04,984 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:04,984 - INFO - ##################################################
2024-10-23 19:59:04,984 - INFO - Establishing database connection...
2024-10-23 19:59:05,149 - INFO - Database connection established successfully.
2024-10-23 19:59:05,150 - INFO - SQL filename: Fastest Growth in Spending.sql
2024-10-23 19:59:05,151 - INFO - SQL query read from file: WITH TransactionCounts AS (
    SELECT 
        card_type,
        COUNT(*) AS transaction_count,
        SUM(amount) AS total_spend
    FROM 
        transactions
    GROUP BY 
        card_type
)
SELECT TOP 1 
    card_type,
    transaction_count,
    total_spend,
    (total_spend * 1.0 / transaction_count) AS average_spend_per_transaction
FROM 
    TransactionCounts
ORDER BY 
    average_spend_per_transaction DESC;

2024-10-23 19:59:05,216 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 19:59:05,222 - INFO - Cursor closed.
2024-10-23 19:59:05,223 - INFO - Database connection closed.
2024-10-23 19:59:07,021 - INFO - Appending to existing log file.
2024-10-23 19:59:07,022 - INFO - ##################################################
2024-10-23 19:59:07,022 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:07,022 - INFO - ##################################################
2024-10-23 19:59:07,022 - INFO - Establishing database connection...
2024-10-23 19:59:07,058 - INFO - Database connection established successfully.
2024-10-23 19:59:07,058 - INFO - SQL filename: Highest Spending Gender.sql
2024-10-23 19:59:07,058 - INFO - SQL query read from file: SELECT 
    city,
    gender,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    gender
ORDER BY 
    city, 
    total_spend DESC;

2024-10-23 19:59:07,161 - INFO - SQL query executed successfully. Retrieved 1876 rows.
2024-10-23 19:59:07,175 - INFO - Cursor closed.
2024-10-23 19:59:07,175 - INFO - Database connection closed.
2024-10-23 19:59:08,455 - INFO - Appending to existing log file.
2024-10-23 19:59:08,456 - INFO - ##################################################
2024-10-23 19:59:08,456 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:08,456 - INFO - ##################################################
2024-10-23 19:59:08,456 - INFO - Establishing database connection...
2024-10-23 19:59:08,535 - INFO - Database connection established successfully.
2024-10-23 19:59:08,535 - INFO - SQL filename: Spend by Gender Across Cities.sql
2024-10-23 19:59:08,536 - INFO - SQL query read from file: SELECT 
    city,
    gender,
    SUM(amount) AS total_spend,
    (SUM(amount) * 100.0 / (SELECT SUM(amount) FROM transactions WHERE city = ct.city)) AS percentage_contribution
FROM 
    transactions ct
GROUP BY 
    city, 
    gender;
2024-10-23 19:59:08,642 - INFO - SQL query executed successfully. Retrieved 1876 rows.
2024-10-23 19:59:08,657 - INFO - Cursor closed.
2024-10-23 19:59:08,658 - INFO - Database connection closed.
2024-10-23 19:59:10,013 - INFO - Appending to existing log file.
2024-10-23 19:59:10,014 - INFO - ##################################################
2024-10-23 19:59:10,014 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:10,014 - INFO - ##################################################
2024-10-23 19:59:10,014 - INFO - Establishing database connection...
2024-10-23 19:59:10,071 - INFO - Database connection established successfully.
2024-10-23 19:59:10,072 - INFO - SQL filename: Spend Distribution Across Card Types.sql
2024-10-23 19:59:10,072 - INFO - SQL query read from file: SELECT 
    card_type, 
    MAX(amount) AS highest_spend_amount, 
    MIN(amount) AS lowest_spend_amount
FROM 
    transactions
GROUP BY 
    card_type;
2024-10-23 19:59:10,115 - INFO - SQL query executed successfully. Retrieved 4 rows.
2024-10-23 19:59:10,121 - INFO - Cursor closed.
2024-10-23 19:59:10,122 - INFO - Database connection closed.
2024-10-23 19:59:15,393 - INFO - Appending to existing log file.
2024-10-23 19:59:15,393 - INFO - ##################################################
2024-10-23 19:59:15,393 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:15,394 - INFO - ##################################################
2024-10-23 19:59:15,394 - INFO - Establishing database connection...
2024-10-23 19:59:15,438 - INFO - Database connection established successfully.
2024-10-23 19:59:15,439 - INFO - SQL filename: Top 5 Expense Categories.sql
2024-10-23 19:59:15,439 - INFO - SQL query read from file: 
SELECT top 5
    exp_type, 
    SUM(amount) AS total_spend,
    (SUM(amount) * 100.0 / (SELECT SUM(amount) FROM DEProject.dbo.transactions)) AS percentage_contribution
FROM 
    [transactions]
GROUP BY 
    exp_type
ORDER BY 
    total_spend DESC;
2024-10-23 19:59:15,560 - INFO - SQL query executed successfully. Retrieved 5 rows.
2024-10-23 19:59:15,565 - INFO - Cursor closed.
2024-10-23 19:59:15,567 - INFO - Database connection closed.
2024-10-23 19:59:19,520 - INFO - Appending to existing log file.
2024-10-23 19:59:19,520 - INFO - ##################################################
2024-10-23 19:59:19,520 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:19,520 - INFO - ##################################################
2024-10-23 19:59:19,520 - INFO - Establishing database connection...
2024-10-23 19:59:19,611 - INFO - Database connection established successfully.
2024-10-23 19:59:19,612 - INFO - SQL filename: Weekend vs Weekday Transaction Patterns.sql
2024-10-23 19:59:19,613 - INFO - SQL query read from file: SELECT 
    city,
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END AS day_type,
    COUNT(*) AS total_transactions,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END;

2024-10-23 19:59:19,698 - INFO - SQL query executed successfully. Retrieved 1783 rows.
2024-10-23 19:59:19,710 - INFO - Cursor closed.
2024-10-23 19:59:19,711 - INFO - Database connection closed.
2024-10-23 19:59:21,308 - INFO - Appending to existing log file.
2024-10-23 19:59:21,308 - INFO - ##################################################
2024-10-23 19:59:21,308 - INFO - STEP 3 : Creating Reports
2024-10-23 19:59:21,309 - INFO - ##################################################
2024-10-23 19:59:21,309 - INFO - Establishing database connection...
2024-10-23 19:59:21,370 - INFO - Database connection established successfully.
2024-10-23 19:59:21,370 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 19:59:21,370 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 19:59:21,492 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 19:59:21,498 - INFO - Cursor closed.
2024-10-23 19:59:21,499 - INFO - Database connection closed.
