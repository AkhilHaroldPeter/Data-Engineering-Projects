2024-10-23 21:51:54,115 - INFO - Created new log file.
2024-10-23 21:51:54,124 - INFO - ##################################################
2024-10-23 21:51:54,124 - INFO - STEP 3 : Creating Reports
2024-10-23 21:51:54,124 - INFO - ##################################################
2024-10-23 21:51:54,124 - INFO - Establishing database connection...
2024-10-23 21:51:54,289 - INFO - Database connection established successfully.
2024-10-23 21:51:54,290 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 21:51:54,290 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 21:51:55,043 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 21:51:55,053 - INFO - Cursor closed.
2024-10-23 21:51:55,056 - INFO - Database connection closed.
2024-10-23 22:04:38,017 - INFO - Appending to existing log file.
2024-10-23 22:04:38,017 - INFO - ##################################################
2024-10-23 22:04:38,018 - INFO - STEP 3 : Creating Reports
2024-10-23 22:04:38,018 - INFO - ##################################################
2024-10-23 22:04:38,018 - INFO - Establishing database connection...
2024-10-23 22:04:38,162 - INFO - Database connection established successfully.
2024-10-23 22:04:38,162 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 22:04:38,163 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 22:04:38,281 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 22:04:38,289 - INFO - Cursor closed.
2024-10-23 22:04:38,291 - INFO - Database connection closed.
2024-10-23 22:04:49,454 - INFO - Appending to existing log file.
2024-10-23 22:04:49,454 - INFO - ##################################################
2024-10-23 22:04:49,454 - INFO - STEP 3 : Creating Reports
2024-10-23 22:04:49,454 - INFO - ##################################################
2024-10-23 22:04:49,455 - INFO - Establishing database connection...
2024-10-23 22:04:49,497 - INFO - Database connection established successfully.
2024-10-23 22:04:49,498 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 22:04:49,498 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 22:04:49,570 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 22:04:49,576 - INFO - Cursor closed.
2024-10-23 22:04:49,577 - INFO - Database connection closed.
