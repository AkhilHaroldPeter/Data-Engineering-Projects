2024-10-23 19:56:27,098 - INFO - Created new session log file.
2024-10-23 19:56:27,100 - INFO - ##################################################
2024-10-23 19:56:27,100 - INFO - STEP 1 : Extarcting data from kagggle
2024-10-23 19:56:27,100 - INFO - ##################################################
2024-10-23 19:56:27,100 - INFO - Starting data download...
2024-10-23 19:56:29,001 - INFO - Files in the zip archive: ['Credit card transactions - India - Simple.csv']
2024-10-23 19:56:29,002 - INFO - Processing the data in chunks...
2024-10-23 19:56:29,023 - INFO - Processed 10000 rows of data.
2024-10-23 19:56:29,049 - INFO - Processed 10000 rows of data.
2024-10-23 19:56:29,058 - INFO - Processed 6052 rows of data.
2024-10-23 19:56:29,157 - INFO - Data processing and transmission to NiFi completed successfully.
2024-10-23 19:58:18,747 - INFO - Appending to existing log file.
2024-10-23 19:58:18,888 - INFO - ##################################################
2024-10-23 19:58:18,888 - INFO - STEP 2 : Pushing the data to table
2024-10-23 19:58:18,888 - INFO - ##################################################
2024-10-23 19:58:18,944 - INFO - Table 'transactions' created.
2024-10-23 19:58:36,449 - INFO - Data processing completed successfully. Total records pushed: 26052.
2024-10-23 20:00:52,668 - INFO - Appending to existing log file.
2024-10-23 20:00:52,668 - INFO - ##################################################
2024-10-23 20:00:52,668 - INFO - STEP 3 : Creating Reports
2024-10-23 20:00:52,668 - INFO - ##################################################
2024-10-23 20:00:52,669 - INFO - Establishing database connection...
2024-10-23 20:00:52,790 - INFO - Database connection established successfully.
2024-10-23 20:00:52,792 - INFO - SQL filename: Average Spend Per Transaction by Card Type.sql
2024-10-23 20:00:52,793 - INFO - SQL query read from file: SELECT 
    card_type, 
    YEAR(transaction_date) AS transaction_year,
    MONTH(transaction_date) AS transaction_month,
    AVG(amount) AS average_spend_per_transaction
FROM 
    transactions
GROUP BY 
    card_type, 
    YEAR(transaction_date),
    MONTH(transaction_date);
2024-10-23 20:00:52,876 - INFO - SQL query executed successfully. Retrieved 80 rows.
2024-10-23 20:00:52,881 - INFO - Cursor closed.
2024-10-23 20:00:52,882 - INFO - Database connection closed.
2024-10-23 20:01:19,228 - INFO - Appending to existing log file.
2024-10-23 20:01:19,229 - INFO - ##################################################
2024-10-23 20:01:19,229 - INFO - STEP 3 : Creating Reports
2024-10-23 20:01:19,229 - INFO - ##################################################
2024-10-23 20:01:19,229 - INFO - Establishing database connection...
2024-10-23 20:01:19,362 - INFO - Database connection established successfully.
2024-10-23 20:01:19,363 - INFO - SQL filename: Cumulative Spend by City.sql
2024-10-23 20:01:19,364 - INFO - SQL query read from file: WITH CumulativeSpending AS (
    SELECT 
        city,
        transaction_date,
        SUM(amount) OVER (PARTITION BY city ORDER BY transaction_date) AS cumulative_spend
    FROM 
        transactions
)
SELECT 
    city,
    MIN(transaction_date) AS first_date_to_reach_500k
FROM 
    CumulativeSpending
WHERE 
    cumulative_spend >= 500000
GROUP BY 
    city;

2024-10-23 20:01:20,116 - INFO - SQL query executed successfully. Retrieved 796 rows.
2024-10-23 20:01:20,122 - INFO - Cursor closed.
2024-10-23 20:01:20,124 - INFO - Database connection closed.
