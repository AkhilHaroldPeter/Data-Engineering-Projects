2024-10-23 20:51:25,900 - INFO - Created new log file.
2024-10-23 20:51:25,915 - INFO - ##################################################
2024-10-23 20:51:25,916 - INFO - STEP 3 : Creating Reports
2024-10-23 20:51:25,916 - INFO - ##################################################
2024-10-23 20:51:25,916 - INFO - Establishing database connection...
2024-10-23 20:51:26,033 - INFO - Database connection established successfully.
2024-10-23 20:51:26,042 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 20:51:26,042 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 20:51:26,155 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 20:51:26,162 - INFO - Cursor closed.
2024-10-23 20:51:26,165 - INFO - Database connection closed.
2024-10-23 21:08:13,226 - INFO - Appending to existing log file.
2024-10-23 21:08:13,229 - INFO - ##################################################
2024-10-23 21:08:13,229 - INFO - STEP 3 : Creating Reports
2024-10-23 21:08:13,229 - INFO - ##################################################
2024-10-23 21:08:13,229 - INFO - Establishing database connection...
2024-10-23 21:08:13,406 - INFO - Database connection established successfully.
2024-10-23 21:08:13,407 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-23 21:08:13,407 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-23 21:08:13,535 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-23 21:08:13,541 - INFO - Cursor closed.
2024-10-23 21:08:13,542 - INFO - Database connection closed.
2024-10-23 21:16:42,022 - INFO - Appending to existing log file.
2024-10-23 21:16:42,023 - INFO - ##################################################
2024-10-23 21:16:42,023 - INFO - STEP 3 : Creating Reports
2024-10-23 21:16:42,023 - INFO - ##################################################
2024-10-23 21:16:42,023 - INFO - Establishing database connection...
2024-10-23 21:16:42,198 - INFO - Database connection established successfully.
2024-10-23 21:16:42,210 - INFO - SQL filename: Weekend vs Weekday Transaction Patterns.sql
2024-10-23 21:16:42,210 - INFO - SQL query read from file: SELECT 
    city,
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END AS day_type,
    COUNT(*) AS total_transactions,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END;

2024-10-23 21:16:42,319 - INFO - SQL query executed successfully. Retrieved 1783 rows.
2024-10-23 21:16:42,337 - INFO - Cursor closed.
2024-10-23 21:16:42,337 - INFO - Database connection closed.
2024-10-23 21:18:10,078 - INFO - Appending to existing log file.
2024-10-23 21:18:10,078 - INFO - ##################################################
2024-10-23 21:18:10,079 - INFO - STEP 3 : Creating Reports
2024-10-23 21:18:10,079 - INFO - ##################################################
2024-10-23 21:18:10,079 - INFO - Establishing database connection...
2024-10-23 21:18:10,214 - INFO - Database connection established successfully.
2024-10-23 21:18:10,215 - INFO - SQL filename: Weekend vs Weekday Transaction Patterns.sql
2024-10-23 21:18:10,215 - INFO - SQL query read from file: SELECT 
    city,
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END AS day_type,
    COUNT(*) AS total_transactions,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END;

2024-10-23 21:18:10,308 - INFO - SQL query executed successfully. Retrieved 1783 rows.
2024-10-23 21:18:10,319 - INFO - Cursor closed.
2024-10-23 21:18:10,320 - INFO - Database connection closed.
