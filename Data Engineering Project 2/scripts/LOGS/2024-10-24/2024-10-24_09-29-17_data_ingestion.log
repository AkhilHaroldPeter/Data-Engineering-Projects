2024-10-24 09:29:17,188 - INFO - Created new log file.
2024-10-24 09:29:17,189 - INFO - ##################################################
2024-10-24 09:29:17,189 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,189 - INFO - ##################################################
2024-10-24 09:29:17,189 - INFO - Establishing database connection...
2024-10-24 09:29:17,191 - INFO - Created new log file.
2024-10-24 09:29:17,193 - INFO - ##################################################
2024-10-24 09:29:17,193 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,193 - INFO - ##################################################
2024-10-24 09:29:17,193 - INFO - Establishing database connection...
2024-10-24 09:29:17,198 - INFO - Created new log file.
2024-10-24 09:29:17,198 - INFO - Created new log file.
2024-10-24 09:29:17,199 - INFO - ##################################################
2024-10-24 09:29:17,199 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,199 - INFO - ##################################################
2024-10-24 09:29:17,199 - INFO - Establishing database connection...
2024-10-24 09:29:17,199 - INFO - ##################################################
2024-10-24 09:29:17,199 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,199 - INFO - ##################################################
2024-10-24 09:29:17,199 - INFO - Establishing database connection...
2024-10-24 09:29:17,222 - INFO - Created new log file.
2024-10-24 09:29:17,223 - INFO - ##################################################
2024-10-24 09:29:17,223 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,223 - INFO - ##################################################
2024-10-24 09:29:17,223 - INFO - Establishing database connection...
2024-10-24 09:29:17,226 - INFO - Created new log file.
2024-10-24 09:29:17,227 - INFO - ##################################################
2024-10-24 09:29:17,227 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,227 - INFO - ##################################################
2024-10-24 09:29:17,227 - INFO - Establishing database connection...
2024-10-24 09:29:17,241 - INFO - Created new log file.
2024-10-24 09:29:17,242 - INFO - ##################################################
2024-10-24 09:29:17,242 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,242 - INFO - ##################################################
2024-10-24 09:29:17,242 - INFO - Establishing database connection...
2024-10-24 09:29:17,245 - INFO - Created new log file.
2024-10-24 09:29:17,245 - INFO - Created new log file.
2024-10-24 09:29:17,245 - INFO - Database connection established successfully.
2024-10-24 09:29:17,246 - INFO - ##################################################
2024-10-24 09:29:17,246 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,246 - INFO - ##################################################
2024-10-24 09:29:17,246 - INFO - ##################################################
2024-10-24 09:29:17,246 - INFO - SQL filename: Spend by Gender Across Cities.sql
2024-10-24 09:29:17,246 - INFO - Establishing database connection...
2024-10-24 09:29:17,246 - INFO - STEP 3 : Creating Reports
2024-10-24 09:29:17,246 - INFO - SQL query read from file: SELECT 
    city,
    gender,
    SUM(amount) AS total_spend,
    (SUM(amount) * 100.0 / (SELECT SUM(amount) FROM transactions WHERE city = ct.city)) AS percentage_contribution
FROM 
    transactions ct
GROUP BY 
    city, 
    gender;
2024-10-24 09:29:17,246 - INFO - ##################################################
2024-10-24 09:29:17,246 - INFO - Establishing database connection...
2024-10-24 09:29:17,251 - INFO - Database connection established successfully.
2024-10-24 09:29:17,251 - INFO - SQL filename: Cumulative Spend by City.sql
2024-10-24 09:29:17,251 - INFO - SQL query read from file: WITH CumulativeSpending AS (
    SELECT 
        city,
        transaction_date,
        SUM(amount) OVER (PARTITION BY city ORDER BY transaction_date) AS cumulative_spend
    FROM 
        transactions
)
SELECT 
    city,
    MIN(transaction_date) AS first_date_to_reach_500k
FROM 
    CumulativeSpending
WHERE 
    cumulative_spend >= 500000
GROUP BY 
    city;

2024-10-24 09:29:17,256 - INFO - Database connection established successfully.
2024-10-24 09:29:17,257 - INFO - Database connection established successfully.
2024-10-24 09:29:17,257 - INFO - SQL filename: Spend Distribution Across Card Types.sql
2024-10-24 09:29:17,257 - INFO - SQL query read from file: SELECT 
    card_type, 
    MAX(amount) AS highest_spend_amount, 
    MIN(amount) AS lowest_spend_amount
FROM 
    transactions
GROUP BY 
    card_type;
2024-10-24 09:29:17,257 - INFO - SQL filename: Highest Spending Gender.sql
2024-10-24 09:29:17,257 - INFO - SQL query read from file: SELECT 
    city,
    gender,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    gender
ORDER BY 
    city, 
    total_spend DESC;

2024-10-24 09:29:17,311 - INFO - Database connection established successfully.
2024-10-24 09:29:17,312 - INFO - SQL filename: Average Spend Per Transaction by Card Type.sql
2024-10-24 09:29:17,312 - INFO - SQL query read from file: SELECT 
    card_type, 
    YEAR(transaction_date) AS transaction_year,
    MONTH(transaction_date) AS transaction_month,
    AVG(amount) AS average_spend_per_transaction
FROM 
    transactions
GROUP BY 
    card_type, 
    YEAR(transaction_date),
    MONTH(transaction_date);
2024-10-24 09:29:17,312 - INFO - Database connection established successfully.
2024-10-24 09:29:17,312 - INFO - SQL filename: Fastest Growth in Spending.sql
2024-10-24 09:29:17,312 - INFO - SQL query read from file: WITH TransactionCounts AS (
    SELECT 
        card_type,
        COUNT(*) AS transaction_count,
        SUM(amount) AS total_spend
    FROM 
        transactions
    GROUP BY 
        card_type
)
SELECT TOP 1 
    card_type,
    transaction_count,
    total_spend,
    (total_spend * 1.0 / transaction_count) AS average_spend_per_transaction
FROM 
    TransactionCounts
ORDER BY 
    average_spend_per_transaction DESC;

2024-10-24 09:29:17,321 - INFO - Database connection established successfully.
2024-10-24 09:29:17,322 - INFO - SQL filename: Year over Year Spend Growth.sql
2024-10-24 09:29:17,322 - INFO - SQL query read from file: WITH YearlySpend AS (
    SELECT 
        city,
        card_type,
        YEAR(transaction_date) AS year,
        SUM(amount) AS total_spend
    FROM 
        transactions
    WHERE 
        YEAR(transaction_date) IN (2013, 2014)
    GROUP BY 
        city, 
        card_type, 
        YEAR(transaction_date)
)
SELECT 
    y2014.city,
    y2014.card_type,
    (y2014.total_spend - COALESCE(y2013.total_spend, 0)) AS growth
FROM 
    YearlySpend y2014
LEFT JOIN 
    YearlySpend y2013 
ON 
    y2014.city = y2013.city 
    AND y2014.card_type = y2013.card_type 
    AND y2013.year = 2013
WHERE 
    y2014.year = 2014
ORDER BY 
    growth DESC
OFFSET 0 ROWS FETCH NEXT 1 ROW ONLY; -- SQL Server syntax for LIMIT

2024-10-24 09:29:17,323 - INFO - SQL query executed successfully. Retrieved 4 rows.
2024-10-24 09:29:17,323 - INFO - Database connection established successfully.
2024-10-24 09:29:17,324 - INFO - SQL filename: Weekend vs Weekday Transaction Patterns.sql
2024-10-24 09:29:17,324 - INFO - SQL query read from file: SELECT 
    city,
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END AS day_type,
    COUNT(*) AS total_transactions,
    SUM(amount) AS total_spend
FROM 
    transactions
GROUP BY 
    city, 
    CASE 
        WHEN DATEPART(WEEKDAY, transaction_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday' 
    END;

2024-10-24 09:29:17,327 - INFO - Cursor closed.
2024-10-24 09:29:17,330 - INFO - Database connection closed.
2024-10-24 09:29:17,343 - INFO - SQL query executed successfully. Retrieved 1876 rows.
2024-10-24 09:29:17,351 - INFO - Cursor closed.
2024-10-24 09:29:17,360 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-24 09:29:17,364 - INFO - Cursor closed.
2024-10-24 09:29:17,365 - INFO - Database connection established successfully.
2024-10-24 09:29:17,365 - INFO - Database connection closed.
2024-10-24 09:29:17,366 - INFO - SQL filename: Top 5 Expense Categories.sql
2024-10-24 09:29:17,366 - INFO - SQL query read from file: 
SELECT top 5
    exp_type, 
    SUM(amount) AS total_spend,
    (SUM(amount) * 100.0 / (SELECT SUM(amount) FROM DEProject.dbo.transactions)) AS percentage_contribution
FROM 
    [transactions]
GROUP BY 
    exp_type
ORDER BY 
    total_spend DESC;
2024-10-24 09:29:17,374 - INFO - SQL query executed successfully. Retrieved 80 rows.
2024-10-24 09:29:17,378 - INFO - Cursor closed.
2024-10-24 09:29:17,378 - INFO - Database connection closed.
2024-10-24 09:29:17,396 - INFO - Database connection closed.
2024-10-24 09:29:17,436 - INFO - SQL query executed successfully. Retrieved 5 rows.
2024-10-24 09:29:17,437 - INFO - SQL query executed successfully. Retrieved 1783 rows.
2024-10-24 09:29:17,441 - INFO - Cursor closed.
2024-10-24 09:29:17,441 - INFO - SQL query executed successfully. Retrieved 1 rows.
2024-10-24 09:29:17,444 - INFO - Database connection closed.
2024-10-24 09:29:17,445 - INFO - Cursor closed.
2024-10-24 09:29:17,446 - INFO - Cursor closed.
2024-10-24 09:29:17,448 - INFO - Database connection closed.
2024-10-24 09:29:17,448 - INFO - Database connection closed.
2024-10-24 09:29:17,488 - INFO - SQL query executed successfully. Retrieved 1876 rows.
2024-10-24 09:29:17,500 - INFO - Cursor closed.
2024-10-24 09:29:17,504 - INFO - Database connection closed.
2024-10-24 09:29:17,997 - INFO - SQL query executed successfully. Retrieved 796 rows.
2024-10-24 09:29:18,003 - INFO - Cursor closed.
2024-10-24 09:29:18,004 - INFO - Database connection closed.
